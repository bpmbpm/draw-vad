## VAD MetaModel
### 1 Stencil
Создаем трафарет, [Stencil](https://github.com/bpmbpm/doc/blob/main/BPM/graphic_editor/visio/terms.md) - корпоративный трафарет VAD.  
Состав:
#### Shape
- заголовок процесса. Заголовок процесса - его код (например, p1.2.3), его дочерний элемент - имя (без кода). Полное название = код + имя. Код = имя файла. Переменные: id, name, fullname (составной). Тип = VAD-процесс.
- подпроцесс. Может быть типов:
  - базовый, baseVAD
  - детализированный, detailVAD
  - внешний, externVAD
  - предваряющий, последующий (в дальнейшей реализации)
имеет два дочерних: исполнитель (поле снизу) и комментарий (справа сверху)
- коментарий к схеме процесса. Текстовое поля, которое содержит как коментарии к самомй схеме процесса, так и пояснения к коментариям к фишурам, если они заданы ссылочно (*, 2).
#### Predicate  
- связи в составе фигуры (см. выше, shape)
- имеет следующего (hasNext), может содержать комментарий (в нем можно показывать условие ветвления)

### 2 Pic
При отрисовке соединения (предиката), проверить а) в XML: source="Название_процесса_1" edge="1" target="Название_процесса_2"> и "зеленые коннекторы" файле:  
![ris11](https://github.com/bpmbpm/draw-vad/blob/main/notation/pic/VAD-notation.png)

#### id code
Правила замены id на человекочитаемые (shape)
- если имя шейпа (не дочернего) начинается не с "p", то вместо пробелов вставляем "_". Если с "p", то вырезаем левую часть до первого пробела.
- запомнить заменяемый id и вместо него везде подставить новый
- для FF6666 ххх - в этой строке к parent="Название_процесса_2" прибавить Role,"Название_процесса_2!Role"
- для FF6666 - в этой строке к parent="Название_процесса_2" прибавить Com, т.е. id="Название_процесса_2!Com"


### 3 Problem
Как в XML задавать тип фигуры? 
- стандартными шейпами
- сделать свой шейп \ имя шейпа. Если через вкладку 
Например: Создали step (библиотека Общие). Его нужно исправить, т.к. работать с ним сложно: стрелка в левую сторону shape перекрывает текст. Поэтому нужно «выпрямить» левую сторону shape=step.  
Делаем собственную фигуру «Исправленный step»: **Положение \ добавить \ фигура.**
``` <shape name="stencilName1" h="24" w="100" aspect="variable" strokewidth="inherit">
  <background>
    <path>
      <move x="0" y="0"/>
      <line x="80" y="0"/>
      <line x="100" y="12"/>
      <line x="80" y="24"/>
      <line x="0" y="24"/>
      <close/>
    </path>
  </background>
  <foreground>
    <fillstroke/>
    
    <stroke/>
  </foreground>
</shape>
```
Хотя можно взять и схожие: Signal-in arrow (Стрелки) или Send Object Action (UML 2.5).  
https://www.drawio.com/doc/faq/shape-complex-create-edit  
https://www.drawio.com/doc/faq/custom-shapes  
#### Problem 1
Проблема в том, что а) создается длинное и непонятное имя шейпа б) все равно нужно доопрделять стиль (style) цвет и т.п.  
Текущее решение: используем стандартные шейпы, в стиле определяем ключевой элемент цвет или название шейпа и по нему определяем тип фигуры \ объекта.  
см. vad5.drawio \ lib5.xml

### Help
- Дополнительно \ Редактировать диаграмму (XML)
- Кодировка UTF-8 no BOM
